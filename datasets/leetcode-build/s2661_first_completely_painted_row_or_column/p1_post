The returned index `i` is the smallest index at which either a row or a column is completely painted in `mat`.
