The input grid must be a 2D array of positive integers.
The grid must have at least 2 rows and 2 columns.
The grid must have at most 1000 rows and 1000 columns.
The total number of cells in the grid must be between 4 and 10^5.
The values in the grid must be between 1 and 10^6.
